<?xml version="1.0" encoding="UTF-8"?>

<?import de.jensd.fx.glyphs.fontawesome.FontAwesomeIcon?>
<?import java.net.URL?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>

<AnchorPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.frontend.controller.transaction.ReceivePaymentController">
    <stylesheets>
        <URL value="@../css/master-material.css" />
        <URL value="@../css/receive-payment.css" />
    </stylesheets>

    <SplitPane dividerPositions="0.6" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0"
               AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

    <!-- LEFT PANEL - Payment Entry (60%) -->
    <AnchorPane minWidth="500" styleClass="master-menu-root">
        <VBox spacing="10" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0"
              AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

            <!-- Header -->
            <HBox alignment="CENTER_LEFT" spacing="15" styleClass="receive-payment-header">
                <padding>
                    <Insets bottom="10" left="20" right="20" top="10" />
                </padding>
                <children>
                    <!-- Back Button -->
                    <Button fx:id="btnBack" styleClass="back-button">
                        <graphic>
                            <HBox alignment="CENTER" spacing="8">
                                <FontAwesomeIcon fill="white" glyphName="ARROW_LEFT" size="1.3em" />
                                <Label style="-fx-text-fill: white; -fx-font-weight: bold;" text="BACK" />
                            </HBox>
                        </graphic>
                    </Button>

                    <!-- Title -->
                    <HBox alignment="CENTER" spacing="10">
                        <FontAwesomeIcon fill="white" glyphName="MONEY" size="1.8em" />
                        <Label styleClass="receive-payment-title" text="RECEIVE PAYMENT" />
                    </HBox>

                    <Region HBox.hgrow="ALWAYS" />

                    <!-- Refresh Button -->
                    <Button fx:id="btnRefresh" styleClass="refresh-button">
                        <graphic>
                            <FontAwesomeIcon fill="white" glyphName="REFRESH" size="1.3em" />
                        </graphic>
                    </Button>
                </children>
            </HBox>

            <!-- Main Content -->
            <VBox spacing="8" VBox.vgrow="ALWAYS">
                <padding>
                    <Insets bottom="10" left="15" right="15" top="5" />
                </padding>
                <children>

                    <!-- Customer Selection Section - Two rows layout -->
                    <VBox spacing="8" styleClass="customer-section">
                        <HBox alignment="CENTER_LEFT" spacing="12">
                            <!-- Label and TextField in vertical layout -->
                            <VBox spacing="4" HBox.hgrow="ALWAYS">
                                <Label fx:id="lblCustomerLabel" styleClass="customer-label" text="ga`ahkacao naava:" />
                                <TextField fx:id="txtCustomer" prefHeight="36"
                                           promptText="ga`ahk SaaoQaa..." />
                            </VBox>
                            <Separator orientation="VERTICAL" />
                            <VBox spacing="4" alignment="CENTER">
                                <Label style="-fx-text-fill: #757575; -fx-font-size: 11px;" text="Total Pending:" />
                                <Label fx:id="lblTotalPending" styleClass="pending-amount-label" text="Rs. 0.00" />
                            </VBox>
                        </HBox>
                    </VBox>

                    <!-- Pending Bills Table -->
                    <VBox spacing="6" styleClass="pending-bills-container" VBox.vgrow="ALWAYS">
                        <padding>
                            <Insets bottom="8" left="8" right="8" top="8" />
                        </padding>
                        <children>
                            <HBox alignment="CENTER_LEFT" spacing="10">
                                <Label style="-fx-font-size: 13px; -fx-font-weight: bold; -fx-text-fill: #009688;" text="Pending Credit Bills" />
                                <Label style="-fx-font-size: 10px; -fx-text-fill: #757575;" text="(Ctrl+Click to select multiple bills)" />
                            </HBox>
                            <TableView fx:id="tblPendingBills" styleClass="pending-bills-table" VBox.vgrow="ALWAYS">
                                <columns>
                                    <TableColumn fx:id="colBillNo" maxWidth="70" minWidth="50" prefWidth="60" text="Bill #" />
                                    <TableColumn fx:id="colBillDate" maxWidth="100" minWidth="80" prefWidth="90" text="Date" />
                                    <TableColumn fx:id="colBillTime" maxWidth="80" minWidth="60" prefWidth="70" text="Time" />
                                    <TableColumn fx:id="colNetAmount" maxWidth="110" minWidth="90" prefWidth="100" text="Bill Amt" />
                                    <TableColumn fx:id="colPaidAmount" maxWidth="100" minWidth="80" prefWidth="90" text="Paid" />
                                    <TableColumn fx:id="colBalanceAmount" maxWidth="110" minWidth="90" prefWidth="100" text="Balance" />
                                    <TableColumn fx:id="colStatus" maxWidth="100" minWidth="70" prefWidth="80" text="Status" />
                                </columns>
                                <columnResizePolicy>
                                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                </columnResizePolicy>
                            </TableView>
                        </children>
                    </VBox>

                    <!-- Payment Entry Section - Compact Two Row Layout -->
                    <VBox spacing="6" styleClass="payment-section">
                        <Label styleClass="payment-section-title" text="Payment Details" />

                        <!-- Selected Bills Info (supports multiple selection) -->
                        <HBox fx:id="hboxSelectedBill" alignment="CENTER_LEFT" spacing="15" styleClass="bill-info-box" visible="false">
                            <VBox spacing="2">
                                <Label styleClass="bill-info-label" text="Selected Bills:" />
                                <Label fx:id="lblSelectedBillNo" styleClass="bill-info-value" text="0 bills" />
                            </VBox>
                            <Separator orientation="VERTICAL" />
                            <VBox spacing="2">
                                <Label styleClass="bill-info-label" text="Total Bill Amount:" />
                                <Label fx:id="lblSelectedBillAmount" styleClass="bill-info-value" text="Rs. 0.00" />
                            </VBox>
                            <Separator orientation="VERTICAL" />
                            <VBox spacing="2">
                                <Label styleClass="bill-info-label" text="Total Balance:" />
                                <Label fx:id="lblSelectedBalance" styleClass="bill-info-value" text="Rs. 0.00" />
                            </VBox>
                        </HBox>

                        <!-- Payment Input Fields - Row 1: Amount, Mode, Cheque, Reference -->
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <!-- Payment Amount -->
                            <VBox spacing="2">
                                <Label styleClass="payment-field-label" text="Amount *" />
                                <TextField fx:id="txtPaymentAmount" prefHeight="36" prefWidth="130"
                                           promptText="Enter amount..." styleClass="payment-amount-field" />
                            </VBox>

                            <!-- Payment Mode -->
                            <VBox spacing="2" HBox.hgrow="ALWAYS">
                                <Label styleClass="payment-field-label" text="Payment Mode *" />
                                <ComboBox fx:id="cmbPaymentMode" prefHeight="36"
                                          promptText="Select Bank..." styleClass="payment-mode-combo" HBox.hgrow="ALWAYS" />
                            </VBox>

                            <!-- Cheque No -->
                            <VBox spacing="2">
                                <Label styleClass="payment-field-label" text="Cheque No" />
                                <TextField fx:id="txtChequeNo" prefHeight="36" prefWidth="100"
                                           promptText="Cheque #" styleClass="form-text-field" />
                            </VBox>

                            <!-- Reference No -->
                            <VBox spacing="2">
                                <Label styleClass="payment-field-label" text="Reference No" />
                                <TextField fx:id="txtReferenceNo" prefHeight="36" prefWidth="100"
                                           promptText="Ref #" styleClass="form-text-field" />
                            </VBox>
                        </HBox>

                        <!-- Payment Input Fields - Row 2: Remarks + Buttons -->
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <!-- Remarks -->
                            <VBox spacing="2" HBox.hgrow="ALWAYS">
                                <Label styleClass="payment-field-label" text="Remarks" />
                                <TextField fx:id="txtRemarks" prefHeight="36" promptText="Remarks..."
                                           styleClass="form-text-field" />
                            </VBox>

                            <!-- Action Buttons inline with remarks -->
                            <HBox alignment="CENTER_RIGHT" spacing="8" style="-fx-padding: 18 0 0 0;">
                            <Button fx:id="btnNew" minWidth="80" styleClass="new-button" text="NEW">
                                <graphic>
                                    <FontAwesomeIcon fill="white" glyphName="PLUS" size="1em" />
                                </graphic>
                            </Button>
                            <Button fx:id="btnClear" minWidth="80" styleClass="clear-button" text="CLEAR">
                                <graphic>
                                    <FontAwesomeIcon fill="#303F9F" glyphName="ERASER" size="1em" />
                                </graphic>
                            </Button>
                            <Button fx:id="btnReceive" minWidth="120" styleClass="receive-button" text="RECEIVE">
                                <graphic>
                                    <FontAwesomeIcon fill="white" glyphName="CHECK" size="1.1em" />
                                </graphic>
                            </Button>
                            </HBox>
                        </HBox>
                    </VBox>
                </children>
            </VBox>
        </VBox>
    </AnchorPane>

    <!-- RIGHT PANEL - Payment History (40%) -->
    <AnchorPane minWidth="350" styleClass="history-panel">
        <VBox AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0"
              AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">

            <!-- History Header -->
            <HBox alignment="CENTER_LEFT" spacing="10" styleClass="history-header">
                <FontAwesomeIcon fill="white" glyphName="HISTORY" size="1.3em" />
                <Label styleClass="history-title" text="RECEIPT HISTORY" />
                <Region HBox.hgrow="ALWAYS" />
                <Button fx:id="btnPrint" styleClass="print-button">
                    <graphic>
                        <HBox alignment="CENTER" spacing="5">
                            <FontAwesomeIcon fill="white" glyphName="PRINT" size="1em" />
                            <Label style="-fx-text-fill: white; -fx-font-size: 11px;" text="PRINT" />
                        </HBox>
                    </graphic>
                </Button>
                <Button fx:id="btnRefreshHistory" styleClass="refresh-button">
                    <graphic>
                        <FontAwesomeIcon fill="white" glyphName="REFRESH" size="1em" />
                    </graphic>
                </Button>
            </HBox>

            <!-- Filter Section -->
            <VBox spacing="8" styleClass="history-filter-section">
                <HBox alignment="CENTER_LEFT" spacing="8">
                    <Label style="-fx-text-fill: #757575; -fx-font-size: 11px;" text="From:" />
                    <DatePicker fx:id="dpHistoryFrom" prefWidth="115" styleClass="form-date-picker" />
                    <Label style="-fx-text-fill: #757575; -fx-font-size: 11px;" text="To:" />
                    <DatePicker fx:id="dpHistoryTo" prefWidth="115" styleClass="form-date-picker" />
                </HBox>
                <HBox alignment="CENTER_LEFT" spacing="8">
                    <TextField fx:id="txtHistorySearch" prefHeight="36"
                               promptText="ga`ahk SaaoQaa..."
                               styleClass="form-text-field" HBox.hgrow="ALWAYS" />
                    <Button fx:id="btnSearchHistory" styleClass="search-button" text="Search" />
                    <Button fx:id="btnClearSearch" styleClass="clear-search-button" text="Clear" />
                </HBox>
            </VBox>

            <!-- Payment History Table -->
            <TableView fx:id="tblPaymentHistory" styleClass="history-table" VBox.vgrow="ALWAYS">
                <columns>
                    <TableColumn fx:id="colHistId" maxWidth="50" minWidth="35" prefWidth="40" text="ID" />
                    <TableColumn fx:id="colHistDate" maxWidth="90" minWidth="70" prefWidth="80" text="Date" />
                    <TableColumn fx:id="colHistBillNo" maxWidth="60" minWidth="45" prefWidth="50" text="Bills" />
                    <TableColumn fx:id="colHistCustomer" minWidth="90" prefWidth="110" text="Customer" />
                    <TableColumn fx:id="colHistAmount" maxWidth="100" minWidth="70" prefWidth="85" text="Amount" />
                    <TableColumn fx:id="colHistMode" maxWidth="80" minWidth="55" prefWidth="65" text="Mode" />
                </columns>
                <columnResizePolicy>
                    <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                </columnResizePolicy>
            </TableView>

            <!-- Summary Footer -->
            <HBox styleClass="summary-footer">
                <VBox alignment="CENTER" styleClass="summary-box, summary-box-today" HBox.hgrow="ALWAYS">
                    <Label styleClass="summary-label-title" text="TODAY'S RECEIPTS" />
                    <Label fx:id="lblTodayReceipts" styleClass="summary-label-value" text="Rs. 0.00" />
                </VBox>
                <VBox alignment="CENTER" styleClass="summary-box, summary-box-month" HBox.hgrow="ALWAYS">
                    <Label styleClass="summary-label-title" text="THIS MONTH" />
                    <Label fx:id="lblMonthReceipts" styleClass="summary-label-value" text="Rs. 0.00" />
                </VBox>
            </HBox>
        </VBox>
    </AnchorPane>
    </SplitPane>
</AnchorPane>
